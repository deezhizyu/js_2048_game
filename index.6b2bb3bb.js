!function(){function t(t,e,n){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return n}function e(t,e){!function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];function i(t){return t.map(function(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,void 0);var a=Object.prototype.toString.call(t).slice(8,-1);if("Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()})}function r(t){return t>0?1:t<0?-1:0}var s=new WeakSet,o=new WeakSet,l=new WeakSet,c=new WeakSet,h=new WeakSet,u=new WeakSet;function f(){for(var t=!1,e=0;e<this.state.length;e++)for(var n=0;n<this.state[e].length;n++){if(2048===this.state[e][n]){this.status="win";return}(this.state[e+1]&&this.state[e][n]===this.state[e+1][n]||this.state[e][n+1]&&this.state[e][n]===this.state[e][n+1])&&(t=!0)}t||(this.status="lose")}function v(){for(var t=[],e=0;e<this.state.length;e++)for(var n=0;n<this.state[e].length;n++)0===this.state[e][n]&&t.push([e,n]);return t}function d(){var e=t(this,o,v).call(this),n=e[Math.floor(Math.random()*e.length)];this.state[n[0]][n[1]]=.1>=Math.random()?4:2}function g(t){for(var e=t>0?0:this.state.length-1,n=r(t),a=0;a<this.state.length;a++)for(var i=this.state[a],s=e;s<i.length&&s>=0;s+=n)for(var o=Array(i[s].length).fill(!1),l=t>0?s+1:s-1,c=l;c<i.length&&c>=0;c+=n){if(0===i[s]&&0!==i[c]){i[s]=i[c],i[c]=0;continue}0===i[s]||i[s]!==i[c]||o[a]||(i[s]+=i[c],o[a]=!0,this.score+=i[s],i[c]=0),0!==i[s]&&0!==i[c]&&i[s]!==i[c]&&(o[a]=!0)}}function m(t){for(var e=t>0?0:this.state.length-1,n=r(t),a=e;a<this.state.length&&a>=0;a+=n)for(var i=Array(this.state[a].length).fill(!1),s=this.state[a],o=t>0?a+1:a-1,l=o;l<this.state.length&&l>=0;l+=n)for(var c=this.state[l],h=0;h<s.length;h++){if(0===s[h]&&0!==c[h]){s[h]=c[h],c[h]=0;continue}if(0!==s[h]&&s[h]===c[h]&&!i[h]){s[h]+=c[h],i[h]=!0,this.score+=s[h],c[h]=0;continue}0!==s[h]&&0!==c[h]&&s[h]!==c[h]&&(i[h]=!0)}}function y(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("playing"===this.status||"idle"===this.status){var a=this.state.toString();n?t(this,h,m).call(this,n):t(this,c,g).call(this,e),t(this,s,f).call(this),a!==this.state.toString()&&t(this,l,d).call(this)}}var p=new(function(){var n;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),e(this,s),e(this,o),e(this,l),e(this,c),e(this,h),e(this,u),this.initialState=i(t),this.state=t,this.score=0,this.status="idle"}return n=[{key:"moveLeft",value:function(){t(this,u,y).call(this,1)}},{key:"moveRight",value:function(){t(this,u,y).call(this,-1)}},{key:"moveUp",value:function(){t(this,u,y).call(this,0,1)}},{key:"moveDown",value:function(){t(this,u,y).call(this,0,-1)}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.restart()}},{key:"restart",value:function(){this.status="playing",this.state=i(this.initialState),this.score=0,t(this,l,d).call(this),t(this,l,d).call(this)}}],function(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(r.prototype,n),r}()),S=document.querySelectorAll(".field-row"),w=document.querySelector(".button"),k=document.querySelector(".game-score"),b=document.querySelector(".message-start"),L=document.querySelector(".message-win"),A=document.querySelector(".message-lose"),E="restart",C="start",q=!0;function M(){for(var t=p.getState(),e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++){var a=t[e][n];if(a<2||a%2!=0){S[e].children[n].replaceChildren();continue}var i=document.createElement("div");i.textContent=a,i.classList.add("field-cell","field-cell--".concat(a)),S[e].children[n].replaceChildren(i)}switch(p.getStatus()){case"playing":w.textContent="Restart",w.classList.remove(C),w.classList.add(E),b.classList.add("hidden"),L.classList.add("hidden"),A.classList.add("hidden");break;case"lose":A.classList.remove("hidden");break;case"win":L.classList.remove("hidden")}q&&(w.textContent="Start",w.classList.remove(E),w.classList.add(C)),k.textContent=p.getScore()}w.addEventListener("click",function(){"playing"===p.getStatus()&&!q&&confirm("Are you sure you want to restart the game?")?p.restart():"playing"!==p.getStatus()&&p.start(),M()}),document.addEventListener("keydown",function(t){if("playing"===p.getStatus()){var e=!0;switch(t.key){case"ArrowUp":p.moveUp();break;case"ArrowDown":p.moveDown();break;case"ArrowLeft":p.moveLeft();break;case"ArrowRight":p.moveRight();break;default:e=!1}e&&(q=!1,M())}}),document.addEventListener("touchstart",function(t){var e=(t.touches||t.originalEvent.touches)[0];W=e.clientX,j=e.clientY},!1),document.addEventListener("touchmove",function(t){if(W&&j){var e=t.touches[0].clientX,n=t.touches[0].clientY,a=W-e,i=j-n;Math.abs(a)>Math.abs(i)?a>0?p.moveLeft():p.moveRight():i>0?p.moveUp():p.moveDown(),M(),W=null,j=null}},!1);var W=null,j=null}();
//# sourceMappingURL=index.6b2bb3bb.js.map
