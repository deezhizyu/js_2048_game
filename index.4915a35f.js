const t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];function e(t){return t.map(t=>[...t])}function s(t){return t>0?1:t<0?-1:0}const i=new class{constructor(s=t){this.initialState=e(s),this.state=s,this.score=0,this.status="idle"}#t(){let t=!1;for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++){if(2048===this.state[e][s]){this.status="win";return}(this.state[e+1]&&this.state[e][s]===this.state[e+1][s]||this.state[e][s+1]&&this.state[e][s]===this.state[e][s+1])&&(t=!0)}t||(this.status="lose")}#e(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push([e,s]);return t}#s(){let t=this.#e(),e=t[Math.floor(Math.random()*t.length)];this.state[e[0]][e[1]]=.1>=Math.random()?4:2}#i(t){let e=t>0?0:this.state.length-1,i=s(t);for(let s=0;s<this.state.length;s++){let a=this.state[s];for(let n=e;n<a.length&&n>=0;n+=i){let e=Array(a[n].length).fill(!1),r=t>0?n+1:n-1;for(let t=r;t<a.length&&t>=0;t+=i){if(0===a[n]&&0!==a[t]){a[n]=a[t],a[t]=0;continue}0===a[n]||a[n]!==a[t]||e[s]||(a[n]+=a[t],e[s]=!0,this.score+=a[n],a[t]=0),0!==a[n]&&0!==a[t]&&a[n]!==a[t]&&(e[s]=!0)}}}}#a(t){let e=t>0?0:this.state.length-1,i=s(t);for(let s=e;s<this.state.length&&s>=0;s+=i){let e=Array(this.state[s].length).fill(!1),a=this.state[s],n=t>0?s+1:s-1;for(let t=n;t<this.state.length&&t>=0;t+=i){let s=this.state[t];for(let t=0;t<a.length;t++){if(0===a[t]&&0!==s[t]){a[t]=s[t],s[t]=0;continue}if(0!==a[t]&&a[t]===s[t]&&!e[t]){a[t]+=s[t],e[t]=!0,this.score+=a[t],s[t]=0;continue}0!==a[t]&&0!==s[t]&&a[t]!==s[t]&&(e[t]=!0)}}}}#n(t,e=0){if("playing"!==this.status&&"idle"!==this.status)return;let s=this.state.toString();e?this.#a(e):this.#i(t),this.#t(),s!==this.state.toString()&&this.#s()}moveLeft(){this.#n(1)}moveRight(){this.#n(-1)}moveUp(){this.#n(0,1)}moveDown(){this.#n(0,-1)}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.restart()}restart(){this.status="playing",this.state=e(this.initialState),this.score=0,this.#s(),this.#s()}},a=document.querySelectorAll(".field-row"),n=document.querySelector(".button"),r=document.querySelector(".game-score"),l=document.querySelector(".message-start"),o=document.querySelector(".message-win"),h=document.querySelector(".message-lose"),c="restart",u="start";let d=!0;function f(){let t=i.getState();for(let e=0;e<t.length;e++)for(let s=0;s<t[e].length;s++){let i=t[e][s];if(i<2||i%2!=0){a[e].children[s].replaceChildren();continue}let n=document.createElement("div");n.textContent=i,n.classList.add("field-cell",`field-cell--${i}`),a[e].children[s].replaceChildren(n)}switch(i.getStatus()){case"playing":n.textContent="Restart",n.classList.remove(u),n.classList.add(c),l.classList.add("hidden"),o.classList.add("hidden"),h.classList.add("hidden");break;case"lose":h.classList.remove("hidden");break;case"win":o.classList.remove("hidden")}d&&(n.textContent="Start",n.classList.remove(c),n.classList.add(u)),r.textContent=i.getScore()}n.addEventListener("click",()=>{"playing"===i.getStatus()&&!d&&confirm("Are you sure you want to restart the game?")?i.restart():"playing"!==i.getStatus()&&i.start(),f()}),document.addEventListener("keydown",t=>{if("playing"!==i.getStatus())return;let e=!0;switch(t.key){case"ArrowUp":i.moveUp();break;case"ArrowDown":i.moveDown();break;case"ArrowLeft":i.moveLeft();break;case"ArrowRight":i.moveRight();break;default:e=!1}e&&(d=!1,f())}),document.addEventListener("touchstart",function(t){let e=(t.touches||t.originalEvent.touches)[0];m=e.clientX,g=e.clientY},!1),document.addEventListener("touchmove",function(t){if(!m||!g)return;let e=t.touches[0].clientX,s=t.touches[0].clientY,a=m-e,n=g-s;Math.abs(a)>Math.abs(n)?a>0?i.moveLeft():i.moveRight():n>0?i.moveUp():i.moveDown(),f(),m=null,g=null},!1);let m=null,g=null;
//# sourceMappingURL=index.4915a35f.js.map
